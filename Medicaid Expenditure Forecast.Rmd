---
title: "Medicaid expenditure forecast"
author: "Le Luo"
date: "2024-09-20"
output: pdf_document
---

```{r}
install.packages('prophet')
library(prophet)
install.packages("readxl")
library(readxl)

df <- read_xlsx("/Users/jio/Desktop/EMRTS intern/expenditure data/expenditure combine.xlsx")
head(df)
colnames(df)
```

```{r}
head(df$Time)
head(df$TotalMedicaidExpenditures)

df$Time <- as.numeric(df$Time)

# Correct date conversion (Time is just years, so we add "-01-01" to make it a full date)
df_clean <- data.frame(ds = as.Date(paste0(df$Time, "-01-01"), format="%Y-%m-%d"), y = df$TotalMedicaidExpenditures)

# Remove any rows with missing values
df_clean <- na.omit(df_clean)

# Fit the Prophet model
model <- prophet(df_clean)

future <- make_future_dataframe(model, periods=10, freq = 'year')

forecast <- predict(model, future)
plot(model, forecast)
tail(forecast[c('ds', 'yhat', 'yhat_lower', 'yhat_upper')])
prophet_plot_components(model, forecast)
```
